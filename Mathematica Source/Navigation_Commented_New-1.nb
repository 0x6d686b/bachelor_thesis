(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     80782,       1944]
NotebookOptionsPosition[     78054,       1849]
NotebookOutlinePosition[     78448,       1866]
CellTagsIndexPosition[     78405,       1863]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Lake Routing - Navigation", "Subtitle",
 CellChangeTimes->{{3.540347036484879*^9, 3.540347083471973*^9}, {
  3.5403602736002417`*^9, 3.5403602738783607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"FileNames", "[", "]"}], "//", " ", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.539880757347522*^9, 3.539880845748801*^9}, {
   3.539880960578958*^9, 3.539880975768211*^9}, 3.539881017306497*^9, {
   3.539881072226248*^9, 3.5398810756250477`*^9}, {3.539881108007842*^9, 
   3.539881143252986*^9}, 3.539881332800435*^9, 3.5410794473600616`*^9}],

Cell[BoxData["\<\"/Users/mhk/Documents/ZHAW/ba/Mathematica Source\"\>"], \
"Output",
 CellChangeTimes->{
  3.5398813362674932`*^9, 3.539881427802712*^9, 3.539881912072419*^9, 
   3.539882458059349*^9, 3.539919407505005*^9, 3.539921595403018*^9, 
   3.5399219606646767`*^9, 3.53992612049443*^9, 3.540347333203947*^9, 
   3.540347846984473*^9, 3.5403584050853767`*^9, {3.5403585073312597`*^9, 
   3.540358524626275*^9}, 3.540359003201242*^9, 3.540369938911099*^9, 
   3.5410794487265997`*^9, 3.541079721707272*^9}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"Bodensee_De\:0301cision_Sphere.nb\"\>"},
     {"\<\"Bodensee_Decision_Sphere.nb\"\>"},
     {"\<\"Bodensee_De\:0301cision_Sphere.pdf\"\>"},
     {"\<\"Bodensee_Decision_Sphere.pdf\"\>"},
     {"\<\"Bodensee_Polaire.nb\"\>"},
     {"\<\"Bodensee_Polaire.pdf\"\>"},
     {"\<\"Decision_Sphere_Commented.nb\"\>"},
     {"\<\"Navigation_Commented_New-1.nb\"\>"},
     {"\<\"Navigation_Commented_New.nb\"\>"},
     {"\<\"Polaire.csv\"\>"},
     {"\<\"Polaire.xls\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5398813362674932`*^9, 3.539881427802712*^9, 3.539881912072419*^9, 
   3.539882458059349*^9, 3.539919407505005*^9, 3.539921595403018*^9, 
   3.5399219606646767`*^9, 3.53992612049443*^9, 3.540347333203947*^9, 
   3.540347846984473*^9, 3.5403584050853767`*^9, {3.5403585073312597`*^9, 
   3.540358524626275*^9}, 3.540359003201242*^9, 3.540369938911099*^9, 
   3.5410794487265997`*^9, 3.541079721709792*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Coordinate system", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}}],

Cell[TextData[{
 "The earth is represented as the ",
 Cell[BoxData[
  SubscriptBox["S", 
   RowBox[{"2", " "}]]]],
 "unit sphere immerged in ",
 Cell[BoxData[
  SuperscriptBox["\[DoubleStruckCapitalR]", "3"]]],
 ". Coordinates are {\[Theta], \[Phi]}, where \[Theta] \[Element] [0, 2 \
\[DoubledPi]) spans longitudes eastwardly and \[Phi] \[Element] ",
 Cell[BoxData[
  RowBox[{"[", 
   RowBox[{"-", 
    FractionBox["\[DoubledPi]", "2"]}]}]]],
 ", +",
 Cell[BoxData[
  FractionBox["\[DoubledPi]", "2"]]],
 " ] spans latitudes from south to north pole. The immersion follows the \
standard application:\n\n\t\t\t\t[0, 2 \[DoubledPi])\t \[Times] ",
 Cell[BoxData[
  RowBox[{"[", 
   RowBox[{"-", 
    FractionBox["\[DoubledPi]", "2"]}]}]]],
 ", +",
 Cell[BoxData[
  FractionBox["\[DoubledPi]", "2"]]],
 " ]\t\[LongRightArrow]\t",
 Cell[BoxData[
  SubscriptBox["S", "2"]]],
 " \[Subset] ",
 Cell[BoxData[
  SuperscriptBox["\[DoubleStruckCapitalR]", "3"]]],
 "\n\t\t\t\t\t{\[Theta], \[Phi]}\t\t\[LongRightArrow]\t",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]]]],
 "= ",
 Cell[BoxData[
  RowBox[{"(", GridBox[{
     {
      RowBox[{"cos", 
       RowBox[{"(", "\[Theta]", ")"}], "cos", 
       RowBox[{"(", "\[Phi]", ")"}]}]},
     {
      RowBox[{"sin", 
       RowBox[{"(", "\[Theta]", ")"}], "cos", 
       RowBox[{"(", "\[Phi]", ")"}]}]},
     {
      RowBox[{"sin", 
       RowBox[{"(", "\[Phi]", ")"}]}]}
    }], ")"}]]],
 "\nwith ",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]]]],
 "expressed in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " as:"
}], "Text",
 CellChangeTimes->{{3.538801633642984*^9, 3.538801759920043*^9}, {
   3.5388018064071703`*^9, 3.538801971426918*^9}, {3.538802032195668*^9, 
   3.538802166197021*^9}, {3.5388022073200607`*^9, 3.538802371655703*^9}, {
   3.538802406775433*^9, 3.5388025029257174`*^9}, 3.538802538268412*^9, {
   3.538802575097101*^9, 3.5388025796698627`*^9}, {3.538803917056239*^9, 
   3.538803991571826*^9}, {3.538804068550009*^9, 3.538804087332964*^9}, {
   3.538804135739842*^9, 3.538804258876607*^9}, {3.5388043040852747`*^9, 
   3.5388043485825167`*^9}, {3.5388043790702963`*^9, 3.538804394845508*^9}, {
   3.538831377426848*^9, 3.53883145210973*^9}, 3.539918311914028*^9, {
   3.539918392516955*^9, 3.539918583105762*^9}, {3.539918616544945*^9, 
   3.539918645366067*^9}},
 TextJustification->1.],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", 
       StyleBox["[", "Subsubsection"], "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", 
       StyleBox["[", "Subsubsection"], "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.5050255434655323`*^9, {3.505025592478643*^9, 3.5050255976544647`*^9}, {
   3.505025767303782*^9, 3.5050257679031897`*^9}, 3.505026921177391*^9, {
   3.505032724186059*^9, 3.505032732215208*^9}, {3.505032804490115*^9, 
   3.505032820619421*^9}, {3.505033255049283*^9, 3.5050332575206223`*^9}, {
   3.50503597606157*^9, 3.5050360315805473`*^9}, {3.50503623656341*^9, 
   3.505036244394608*^9}, {3.505036275301214*^9, 3.5050362923157053`*^9}, {
   3.505036363551021*^9, 3.505036377006772*^9}, {3.505036432860445*^9, 
   3.505036463038576*^9}, {3.5050420265070047`*^9, 3.505042045992299*^9}, {
   3.505046900637081*^9, 3.505046939739807*^9}, {3.517834380028007*^9, 
   3.517834403800075*^9}, {3.5178344482943573`*^9, 3.5178345835068502`*^9}, {
   3.517834616503097*^9, 3.517834747509386*^9}, {3.5178348530768013`*^9, 
   3.517834907098538*^9}, {3.517834976080657*^9, 3.5178351330226927`*^9}, {
   3.517835164162401*^9, 3.5178351758632383`*^9}, {3.517835211712729*^9, 
   3.517835313647525*^9}, {3.517835399974678*^9, 3.517835416660222*^9}, {
   3.51783570237678*^9, 3.517835707256497*^9}, {3.517835754092966*^9, 
   3.51783575651563*^9}, 3.517835826357275*^9, {3.517835884919188*^9, 
   3.51783594133849*^9}, 3.517835973501753*^9, {3.5178361272356453`*^9, 
   3.517836147111248*^9}, {3.5178363394201117`*^9, 3.5178364086028137`*^9}, {
   3.517836446890609*^9, 3.517836461052956*^9}, {3.51783671785853*^9, 
   3.517836748807666*^9}, {3.517836782527256*^9, 3.5178367846550493`*^9}, {
   3.5398763087301292`*^9, 3.5398763111046467`*^9}, {3.539918361426837*^9, 
   3.539918381922974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Figure1", "=", 
  RowBox[{"Import", "[", "\"\<Dessin2.jpg\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.539880757347522*^9, 3.539880845748801*^9}, {
   3.539880960578958*^9, 3.539880975768211*^9}, 3.539881017306497*^9, {
   3.539881072226248*^9, 3.5398810756250477`*^9}, {3.539881108007842*^9, 
   3.539881143252986*^9}, {3.539881332800435*^9, 3.539881350774887*^9}, {
   3.540358398169209*^9, 3.540358399757847*^9}, {3.5403589960612288`*^9, 
   3.540358999412627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Import", "::", "\<\"nffil\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"File not found during \\\\\\\
\"\\\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Import\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\".\\\\\\\"\\\", \\\"MT\\\
\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Import/nffil\\\", ButtonNote -> \
\\\"Import::nffil\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.541079721870368*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{
  3.539921596070804*^9, 3.539921960846026*^9, 3.539926120678895*^9, 
   3.5403473340579863`*^9, 3.540347847153908*^9, 3.540358405454145*^9, {
   3.540358507504071*^9, 3.540358524798671*^9}, 3.540359003476754*^9, 
   3.540369939083379*^9, 3.541079721873269*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Orthodromy", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}, {
  3.5388045235470953`*^9, 3.5388045267363253`*^9}}],

Cell[TextData[{
 "An orthodromy is a shortest route linking two locations on a geometrical \
surface, according to the intrisic metric of that surface. Orthodromies are \
usually computed following a extremal principle delivering a second order \
differential equation, whose solution is the orthodromy. On the sphere, \
othodromies are constructed as follow: consider two locations ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "} and  ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "2"], ",", 
    SubscriptBox["\[Phi]", "2"]}]}]]],
 "} on the sphere. Together with the center of the sphere, ",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{
    SubscriptBox["X", "c"], " ", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]]],
 ", the points ",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Phi]", "1"]}], ")"}]]]],
 "and ",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", "2"], ",", 
     SubscriptBox["\[Phi]", "2"]}], ")"}]]]],
 "define a plane whose intersection with the sphere is the circle drawn on \
the sphere, indeed the orthodromy. Of course, starting from",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "}, ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "2"], ",", 
    SubscriptBox["\[Phi]", "2"]}]}]]],
 "} can be reached by travelling on the circle into two, shorter or longer, \
directions.\n\nHistorically, orthodromies on earth are called \
\[OpenCurlyDoubleQuote]arcs of great circle\[CloseCurlyDoubleQuote], whereas \
the arc is indeed the short path.\n\nMaking use of the scalar product between \
the two vectors X1 and X2 on the sphere:\n\n\t\tX1 \[CenterDot] X2 =  \
\[LeftDoubleBracketingBar]X1\[RightDoubleBracketingBar] \
\[LeftDoubleBracketingBar]X2\[RightDoubleBracketingBar] Cos[",
 StyleBox["\[SphericalAngle]",
  FontSize->14],
 "(X1, X2)],\n\t\t\t\t\nthe distance on the sphere between two locations ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "} and  ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "2"], ",", 
    SubscriptBox["\[Phi]", "2"]}]}]]],
 "}  is provided by the module ",
 StyleBox["Ortho",
  FontWeight->"Bold"],
 " computing ",
 Cell[BoxData[
  RowBox[{"ArcCos", "[", 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], ",", 
       SubscriptBox["\[Phi]", "1"]}], ")"}]], ".", " ", 
    SubscriptBox["X", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], ",", 
       SubscriptBox["\[Phi]", "2"]}], ")"}]]}], "]"}]]],
 " (remember that the radius of our sphere is unity). Making use of // \
FullSimplify, it delivers the distance expressed in nautical miles:"
}], "Text",
 CellChangeTimes->{{3.538804543216311*^9, 3.538804681315963*^9}, {
   3.5388047317746363`*^9, 3.5388047423148603`*^9}, {3.538804808186626*^9, 
   3.538804943596469*^9}, {3.538805030156972*^9, 3.538805100112409*^9}, {
   3.538805192686043*^9, 3.538805251355604*^9}, {3.538805302570397*^9, 
   3.538805345128784*^9}, {3.538805381688006*^9, 3.538805404143237*^9}, {
   3.53880543428682*^9, 3.5388055916912117`*^9}, {3.53880562457053*^9, 
   3.5388059153283978`*^9}, {3.538805952665202*^9, 3.538805971230874*^9}, {
   3.5388060024396057`*^9, 3.5388060919361563`*^9}, {3.538806124581565*^9, 
   3.538806214327936*^9}, {3.538806245481192*^9, 3.538806364556712*^9}, {
   3.538806410663506*^9, 3.538806411578264*^9}, {3.538806474440132*^9, 
   3.538806513760606*^9}, {3.5388066337492933`*^9, 3.538806693685274*^9}, {
   3.538806736923739*^9, 3.538806736951487*^9}, {3.538807401291731*^9, 
   3.538807571852789*^9}, {3.538807615953885*^9, 3.5388077144055643`*^9}, {
   3.5388077450369053`*^9, 3.538807767825142*^9}, {3.538807871332077*^9, 
   3.538807871832941*^9}, {3.538807917890204*^9, 3.5388080804199467`*^9}, 
   3.538808115597582*^9, {3.5388081497150707`*^9, 3.5388082497417383`*^9}, {
   3.538808309543104*^9, 3.5388083314600677`*^9}, {3.5388084160341473`*^9, 
   3.538808419792952*^9}, {3.538809310023986*^9, 3.538809313543659*^9}, {
   3.538809459011495*^9, 3.538809461201582*^9}, {3.5388110528589687`*^9, 
   3.538811110579769*^9}, {3.538811146665737*^9, 3.5388111913285713`*^9}, {
   3.53881122656295*^9, 3.538811274455414*^9}, {3.5388113119771233`*^9, 
   3.538811327045393*^9}, {3.538811431390151*^9, 3.538811437323976*^9}, {
   3.538888348902382*^9, 3.538888361472671*^9}, 3.538888404614414*^9, {
   3.5389758893468733`*^9, 3.5389759290200977`*^9}, 3.5394948402235327`*^9, {
   3.539919269149379*^9, 3.539919290996008*^9}, {3.5399194572168493`*^9, 
   3.5399194666751328`*^9}, {3.5399195237290487`*^9, 3.539919538465005*^9}, {
   3.539919594802847*^9, 3.539919624418315*^9}, {3.539919947451294*^9, 
   3.539920007318783*^9}, 3.5399200543999357`*^9, {3.539920297118636*^9, 
   3.539920298070284*^9}, {3.53992035052711*^9, 3.539920368798443*^9}, {
   3.5399206949311438`*^9, 3.539920697891045*^9}, {3.539921117254919*^9, 
   3.539921144478075*^9}, 3.5399223181980333`*^9},
 TextJustification->1.],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X1", ",", "X2"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"\[Theta]1", ",", "\[Phi]1"}], "]"}], ",", 
      RowBox[{"X", "[", 
       RowBox[{"\[Theta]2", ",", "\[Phi]2"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Orthodromy", "=", " ", 
   RowBox[{"X1", ".", "X2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Orform", "=", 
  RowBox[{"%", "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.539919384399918*^9, 3.539919389884452*^9}, {
  3.539919808056981*^9, 3.539919835742881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}], " ", 
   RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Phi]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Phi]2", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.539919425112384*^9, 3.539919843744431*^9, 3.539921596173254*^9, 
   3.539921960979357*^9, 3.539926120765194*^9, 3.540347334690228*^9, 
   3.540347847189925*^9, 3.5403584057168827`*^9, {3.540358507551463*^9, 
   3.5403585248465014`*^9}, 3.540359003592453*^9, 3.5403699392031927`*^9, 
   3.541079721923427*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ortho", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]1", ",", "\[Phi]1", ",", "\[Theta]2", ",", "\[Phi]2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Theta]1", ",", "\[Phi]1", ",", "\[Theta]2", ",", "\[Phi]2"}], 
        "}"}], "=", 
       RowBox[{
        FractionBox["\[Pi]", "180"], 
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"N", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"360", "  ", "60"}], 
         RowBox[{"2", "\[Pi]"}]], " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]1", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]2", "]"}]}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.505322021693964*^9, 3.505322117117168*^9}, {
   3.505322470551972*^9, 3.505322493300127*^9}, {3.5053227481881437`*^9, 
   3.505322750475779*^9}, {3.50532753433702*^9, 3.505327541328607*^9}, {
   3.5053275918557262`*^9, 3.505327595087789*^9}, {3.505623000420884*^9, 
   3.505623016593274*^9}, {3.505630894067705*^9, 3.505630899098854*^9}, 
   3.538804268901705*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Why nautical miles?", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}, {
  3.5388045235470953`*^9, 3.5388045267363253`*^9}, {3.538808492449486*^9, 
  3.5388085000464487`*^9}}],

Cell[TextData[{
 "On earth, one Nautical Mile is the distance separating two locations ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "} and  ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "2"], ",", 
    SubscriptBox["\[Phi]", "2"]}]}]]],
 "}  making with the centre of earth ",
 Cell[BoxData[
  SubscriptBox["X", "c"]]],
 " an angle ",
 StyleBox["\[SphericalAngle]",
  FontSize->18],
 " (",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["X", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Theta]", "1"], ",", 
      SubscriptBox["\[Phi]", "1"]}], ")"}]], ","}]]],
 " ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["X", "c"], " ", ","}]]],
 " ",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", "2"], ",", 
     SubscriptBox["\[Phi]", "2"]}], ")"}]]]],
 ") that equals to one minute of degree.\nThis explains the coefficient ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"360", " ", "60"}], 
   RowBox[{"2", " ", "\[DoubledPi]"}]]]],
 "in the expression of ",
 StyleBox["Ortho",
  FontWeight->"Bold"],
 ". By that way, our computations are performed without any reference to the \
actual radius of earth, or of any planet on which a regatta would be \
organized. Furthemore, computing speed in knots - nautical miles per hour - \
makes us only dependent on the angular rotation of the planet, one full \
rotation of 2 \[DoubledPi] in 24 hours. This definition justifies the way the \
module ",
 StyleBox["Ortho",
  FontWeight->"Bold"],
 " is concieved. This system is valid on any other planet or spherical body. \
Expressed in our usual unit system, the values of the nautical mile and the \
knot would simply be different. And of course, I almost forgot it, on earth 1 \
Nautical Mile = 1.852 km, 1 Knot = 0.514 m/s. \n"
}], "Text",
 CellChangeTimes->{{3.538809261955391*^9, 3.538809270196323*^9}, {
   3.538809349392844*^9, 3.538809353589312*^9}, {3.538809408324045*^9, 
   3.538809438163251*^9}, {3.5388094897223873`*^9, 3.538809522267354*^9}, {
   3.538809735027652*^9, 3.538809788313779*^9}, 3.538809836626122*^9, {
   3.538809872185012*^9, 3.53880993115692*^9}, {3.538809967301291*^9, 
   3.538809981716391*^9}, {3.5388100517273903`*^9, 3.538810072137722*^9}, {
   3.5388101181997957`*^9, 3.538810184333396*^9}, {3.538810248108027*^9, 
   3.5388103124977818`*^9}, {3.538810352512711*^9, 3.5388103852716713`*^9}, {
   3.538810497780417*^9, 3.538810568859378*^9}, {3.5388106576586103`*^9, 
   3.5388107224540367`*^9}, {3.538810777813895*^9, 3.538810782748333*^9}, {
   3.5388108321312103`*^9, 3.538810840563344*^9}, {3.5388109156063004`*^9, 
   3.538810917160789*^9}, {3.538810953680347*^9, 3.53881095469104*^9}, {
   3.538811495923684*^9, 3.538811511463937*^9}, 3.538812079757083*^9, 
   3.538812179137019*^9, {3.538814103251185*^9, 3.538814103791244*^9}, {
   3.538818879027931*^9, 3.5388189356097813`*^9}, {3.538821081133687*^9, 
   3.5388210843804903`*^9}, {3.538821818223803*^9, 3.5388218226548223`*^9}, {
   3.538831475439743*^9, 3.5388314760191317`*^9}, {3.5388318489931507`*^9, 
   3.538831881664341*^9}, {3.538831934606223*^9, 3.538831937733864*^9}, {
   3.538831979284993*^9, 3.538832019899024*^9}, {3.538832055524663*^9, 
   3.538832273193479*^9}, 3.538832667936284*^9, {3.538887843109869*^9, 
   3.538887847991289*^9}, {3.538887880571643*^9, 3.538887900982493*^9}, {
   3.538888438973722*^9, 3.5388884438503437`*^9}},
 TextJustification->1.]
}, Open  ]],

Cell[CellGroupData[{

Cell["Local tangent frame", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}, {
  3.5388045235470953`*^9, 3.5388045267363253`*^9}, {3.538808492449486*^9, 
  3.5388085000464487`*^9}, {3.539920422533615*^9, 3.539920432090354*^9}, {
  3.5399220567490377`*^9, 3.5399220680750217`*^9}, {3.539924881657895*^9, 
  3.539924888521825*^9}}],

Cell[TextData[{
 "On the sphere, the local tangent frame located at ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{"\[Theta]", ",", "\[Phi]"}]}]]],
 "} is the plane tangent to the sphere at that location. It can be given the \
structure of a 2-dimensional vector space (on \[DoubleStruckCapitalR]) with \
basis ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["e", "\[Theta]"], ",", 
    SubscriptBox["e", "\[Phi]"]}]}]]],
 "}.  ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["e", "\[Theta]"], " "}]]],
 "and",
 Cell[BoxData[
  RowBox[{" ", 
   SubscriptBox["e", "\[Phi]"]}]]],
 " are the vectors tangent to the sphere al location",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{"\[Theta]", ",", "\[Phi]"}]}]]],
 "} and tangent to the coordinates lines defined by ",
 Cell[BoxData["\[Theta]"]],
 " and ",
 Cell[BoxData["\[Phi]"]],
 ". Pictured as the two thin black vectors on previons figure, they are \
provided by:\n\n\t\t",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["e", "\[Theta]"], ",", 
    SubscriptBox["e", "\[Phi]"]}]}]]],
 "} = ",
 Cell[BoxData[
  RowBox[{"{", 
   FractionBox["1", 
    RowBox[{"Cos", 
     RowBox[{"(", "\[Phi]", ")"}]}]]}]]],
 " ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["\[PartialD]", "\[Theta]"], 
   SubscriptBox["X", 
    RowBox[{"(", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]]}]]],
 ",",
 Cell[BoxData[
  RowBox[{"  ", 
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Phi]"], 
    SubscriptBox["X", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]]}]}]]],
 "}\n\nThe division by Cos(\[Phi]) in the first term makes the frame \
orthonormal: \[LeftBracketingBar]",
 Cell[BoxData[
  SubscriptBox["e", "\[Theta]"]]],
 "\[RightBracketingBar] = \[LeftBracketingBar]",
 Cell[BoxData[
  SubscriptBox["e", "\[Phi]"]]],
 "\[RightBracketingBar] = 1 at each location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{"\[Theta]", ",", "\[Phi]"}]}]]],
 "} of the sphere, with exception of both poles. Computed hereafter at \
location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "}, the local tangent frame will be used later for the calculation of the \
course angle from location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "} to location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "2"], ",", 
    SubscriptBox["\[Phi]", "2"]}]}]]],
 "}."
}], "Text",
 CellChangeTimes->{{3.538809261955391*^9, 3.538809270196323*^9}, {
   3.538809349392844*^9, 3.538809353589312*^9}, {3.538809408324045*^9, 
   3.538809438163251*^9}, {3.5388094897223873`*^9, 3.538809522267354*^9}, {
   3.538809735027652*^9, 3.538809788313779*^9}, 3.538809836626122*^9, {
   3.538809872185012*^9, 3.53880993115692*^9}, {3.538809967301291*^9, 
   3.538809981716391*^9}, {3.5388100517273903`*^9, 3.538810072137722*^9}, {
   3.5388101181997957`*^9, 3.538810184333396*^9}, {3.538810248108027*^9, 
   3.5388103124977818`*^9}, {3.538810352512711*^9, 3.5388103852716713`*^9}, {
   3.538810497780417*^9, 3.538810568859378*^9}, {3.5388106576586103`*^9, 
   3.5388107224540367`*^9}, {3.538810777813895*^9, 3.538810782748333*^9}, {
   3.5388108321312103`*^9, 3.538810840563344*^9}, {3.5388109156063004`*^9, 
   3.538810917160789*^9}, {3.538810953680347*^9, 3.53881095469104*^9}, {
   3.538811495923684*^9, 3.538811511463937*^9}, 3.538812079757083*^9, 
   3.538812179137019*^9, {3.538814103251185*^9, 3.538814103791244*^9}, {
   3.538818879027931*^9, 3.5388189356097813`*^9}, {3.538821081133687*^9, 
   3.5388210843804903`*^9}, {3.538821818223803*^9, 3.5388218226548223`*^9}, {
   3.538831475439743*^9, 3.5388314760191317`*^9}, {3.5388318489931507`*^9, 
   3.538831881664341*^9}, {3.538831934606223*^9, 3.538831937733864*^9}, {
   3.538831979284993*^9, 3.538832019899024*^9}, {3.538832055524663*^9, 
   3.538832273193479*^9}, 3.538832667936284*^9, {3.538887843109869*^9, 
   3.538887847991289*^9}, {3.538887880571643*^9, 3.538887900982493*^9}, {
   3.538888438973722*^9, 3.5388884438503437`*^9}, {3.539920471849592*^9, 
   3.539920589910989*^9}, {3.5399206302791157`*^9, 3.539920682073175*^9}, {
   3.539920766775166*^9, 3.539920795768882*^9}, {3.539920834575364*^9, 
   3.539920868373942*^9}, {3.539920906396408*^9, 3.53992106596905*^9}, {
   3.539921136127042*^9, 3.5399211379129047`*^9}, {3.53992117554615*^9, 
   3.5399214997250767`*^9}, {3.539921762660283*^9, 3.539921901856885*^9}, {
   3.5399220247803297`*^9, 3.539922031845345*^9}, 3.539922398522931*^9, {
   3.539922505241818*^9, 3.539922506575221*^9}, {3.539924909922544*^9, 
   3.539924945554186*^9}, {3.539927036572548*^9, 3.5399273487004013`*^9}, {
   3.539927407194745*^9, 3.5399274450165243`*^9}, {3.540347156874411*^9, 
   3.540347205289806*^9}, {3.540347236018112*^9, 3.5403472490411797`*^9}, {
   3.540358659291292*^9, 3.540358749029592*^9}},
 TextJustification->1.],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"e\[Theta]1", ",", "e\[Phi]1"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Theta]1"], " ", 
        RowBox[{"X", "[", 
         RowBox[{"\[Theta]1", ",", "\[Phi]1"}], "]"}]}], 
       RowBox[{"Cos", "[", "\[Phi]1", "]"}]], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Phi]1"], " ", 
       RowBox[{"X", "[", 
        RowBox[{"\[Theta]1", ",", "\[Phi]1"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.5050255434655323`*^9, {3.505025592478643*^9, 3.5050255976544647`*^9}, {
   3.505025767303782*^9, 3.5050257679031897`*^9}, 3.505026921177391*^9, {
   3.505032724186059*^9, 3.505032732215208*^9}, {3.505032804490115*^9, 
   3.505032820619421*^9}, {3.505033255049283*^9, 3.5050332575206223`*^9}, {
   3.50503597606157*^9, 3.5050360315805473`*^9}, {3.50503623656341*^9, 
   3.505036244394608*^9}, {3.505036275301214*^9, 3.5050362923157053`*^9}, {
   3.505036363551021*^9, 3.505036377006772*^9}, {3.505036432860445*^9, 
   3.505036463038576*^9}, {3.5050420265070047`*^9, 3.505042045992299*^9}, {
   3.505046900637081*^9, 3.505046939739807*^9}, {3.517834380028007*^9, 
   3.517834403800075*^9}, {3.5178344482943573`*^9, 3.5178345835068502`*^9}, {
   3.517834616503097*^9, 3.517834747509386*^9}, {3.5178348530768013`*^9, 
   3.517834907098538*^9}, {3.517834976080657*^9, 3.5178351330226927`*^9}, {
   3.517835164162401*^9, 3.5178351758632383`*^9}, {3.517835211712729*^9, 
   3.517835313647525*^9}, {3.517835399974678*^9, 3.517835416660222*^9}, {
   3.51783570237678*^9, 3.517835707256497*^9}, {3.517835754092966*^9, 
   3.51783575651563*^9}, 3.517835826357275*^9, {3.517835884919188*^9, 
   3.51783594133849*^9}, 3.517835973501753*^9, {3.5178361272356453`*^9, 
   3.517836147111248*^9}, {3.5178363394201117`*^9, 3.5178364086028137`*^9}, {
   3.517836446890609*^9, 3.517836461052956*^9}, {3.51783671785853*^9, 
   3.517836748807666*^9}, {3.517836782527256*^9, 3.5178367846550493`*^9}, {
   3.5398763087301292`*^9, 3.5398763111046467`*^9}, 3.539918361426837*^9, {
   3.539920207518401*^9, 3.539920241651678*^9}, {3.5399217469930964`*^9, 
   3.539921751936162*^9}, 3.539922743833757*^9, {3.540347304234992*^9, 
   3.540347320894802*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation of the Track (German: Kurs)", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}, {
   3.5388045235470953`*^9, 3.5388045267363253`*^9}, {3.538808492449486*^9, 
   3.5388085000464487`*^9}, {3.539920422533615*^9, 3.539920432090354*^9}, {
   3.5399220567490377`*^9, 3.5399220680750217`*^9}, {3.5399224320730352`*^9, 
   3.539922443440487*^9}, {3.539922492952567*^9, 3.539922496702539*^9}, {
   3.5399229388258343`*^9, 3.5399229425222178`*^9}, 3.540347810667055*^9, {
   3.54034793027212*^9, 3.5403479424795427`*^9}}],

Cell[TextData[{
 "Everything is performed in three spatial dimensions, as pictured on figure \
1. Firstly, the cross product of the two vectors ",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Phi]", "1"]}], ")"}]]]],
 "and ",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", "2"], ",", 
     SubscriptBox["\[Phi]", "2"]}], ")"}]]]],
 "delivers the vector ",
 Cell[BoxData[
  RowBox[{"N", " "}]]],
 "= ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["X", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Theta]", "1"], ",", 
      SubscriptBox["\[Phi]", "1"]}], ")"}]], " "}]]],
 "\[Times]  ",
 Cell[BoxData[
  SubscriptBox["X", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", "2"], ",", 
     SubscriptBox["\[Phi]", "2"]}], ")"}]]]],
 "normal to the plan containing the great circle. A further cross product \
delivers the Track at location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "}:\[LineSeparator]",
 Cell[BoxData[
  SubscriptBox["T", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], ",", 
     SubscriptBox["\[Phi]", "1"]}], ")"}]]]],
 " = ",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{"N", " ", "\[Times]", " ", 
    SubscriptBox["X", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], ",", 
       SubscriptBox["\[Phi]", "1"]}], ")"}]]}]}]]],
 ". Both cross products are combined in the following expression, making N \
implicit: "
}], "Text",
 CellChangeTimes->{{3.538809261955391*^9, 3.538809270196323*^9}, {
   3.538809349392844*^9, 3.538809353589312*^9}, {3.538809408324045*^9, 
   3.538809438163251*^9}, {3.5388094897223873`*^9, 3.538809522267354*^9}, {
   3.538809735027652*^9, 3.538809788313779*^9}, 3.538809836626122*^9, {
   3.538809872185012*^9, 3.53880993115692*^9}, {3.538809967301291*^9, 
   3.538809981716391*^9}, {3.5388100517273903`*^9, 3.538810072137722*^9}, {
   3.5388101181997957`*^9, 3.538810184333396*^9}, {3.538810248108027*^9, 
   3.5388103124977818`*^9}, {3.538810352512711*^9, 3.5388103852716713`*^9}, {
   3.538810497780417*^9, 3.538810568859378*^9}, {3.5388106576586103`*^9, 
   3.5388107224540367`*^9}, {3.538810777813895*^9, 3.538810782748333*^9}, {
   3.5388108321312103`*^9, 3.538810840563344*^9}, {3.5388109156063004`*^9, 
   3.538810917160789*^9}, {3.538810953680347*^9, 3.53881095469104*^9}, {
   3.538811495923684*^9, 3.538811511463937*^9}, 3.538812079757083*^9, 
   3.538812179137019*^9, {3.538814103251185*^9, 3.538814103791244*^9}, {
   3.538818879027931*^9, 3.5388189356097813`*^9}, {3.538821081133687*^9, 
   3.5388210843804903`*^9}, {3.538821818223803*^9, 3.5388218226548223`*^9}, {
   3.538831475439743*^9, 3.5388314760191317`*^9}, {3.5388318489931507`*^9, 
   3.538831881664341*^9}, {3.538831934606223*^9, 3.538831937733864*^9}, {
   3.538831979284993*^9, 3.538832019899024*^9}, {3.538832055524663*^9, 
   3.538832273193479*^9}, 3.538832667936284*^9, {3.538887843109869*^9, 
   3.538887847991289*^9}, {3.538887880571643*^9, 3.538887900982493*^9}, {
   3.538888438973722*^9, 3.5388884438503437`*^9}, {3.539920471849592*^9, 
   3.539920589910989*^9}, {3.5399206302791157`*^9, 3.539920682073175*^9}, {
   3.539920766775166*^9, 3.539920795768882*^9}, {3.539920834575364*^9, 
   3.539920868373942*^9}, {3.539920906396408*^9, 3.53992106596905*^9}, {
   3.539921136127042*^9, 3.5399211379129047`*^9}, {3.53992117554615*^9, 
   3.5399214997250767`*^9}, {3.539921762660283*^9, 3.539921901856885*^9}, {
   3.5399220247803297`*^9, 3.539922031845345*^9}, {3.539922558101407*^9, 
   3.5399226109475946`*^9}, {3.539922644004668*^9, 3.539922703763432*^9}, {
   3.5399227682514067`*^9, 3.539923148662058*^9}, {3.539923230818961*^9, 
   3.5399233321520767`*^9}, {3.539927589425028*^9, 3.539927591439845*^9}, 
   3.540347488266262*^9, {3.54034795297972*^9, 3.540347954418632*^9}, {
   3.540358567594619*^9, 3.5403585715853577`*^9}, {3.540358603466391*^9, 
   3.540358615959426*^9}, {3.5403587899627028`*^9, 3.540358814921167*^9}},
 TextJustification->1.],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TrackVect1", "=", 
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{"X1", ",", "X2"}], "]"}], ",", "X1"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TV1", "=", 
  RowBox[{"%", "//", "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{
  3.5050255434655323`*^9, {3.505025592478643*^9, 3.5050255976544647`*^9}, {
   3.505025767303782*^9, 3.5050257679031897`*^9}, 3.505026921177391*^9, {
   3.505032724186059*^9, 3.505032732215208*^9}, {3.505032804490115*^9, 
   3.505032820619421*^9}, {3.505033255049283*^9, 3.5050332575206223`*^9}, {
   3.50503597606157*^9, 3.5050360315805473`*^9}, {3.50503623656341*^9, 
   3.505036244394608*^9}, {3.505036275301214*^9, 3.5050362923157053`*^9}, {
   3.505036363551021*^9, 3.505036377006772*^9}, {3.505036432860445*^9, 
   3.505036463038576*^9}, {3.5050420265070047`*^9, 3.505042045992299*^9}, {
   3.505046900637081*^9, 3.505046939739807*^9}, {3.517834380028007*^9, 
   3.517834403800075*^9}, {3.5178344482943573`*^9, 3.5178345835068502`*^9}, {
   3.517834616503097*^9, 3.517834735298238*^9}, {3.5178354798261747`*^9, 
   3.517835601303507*^9}, {3.517835643742485*^9, 3.517835655749893*^9}, {
   3.5178365937228527`*^9, 3.51783659777864*^9}, {3.5178375535038958`*^9, 
   3.517837558790195*^9}, {3.517837641861518*^9, 3.51783764671152*^9}, {
   3.51783827324483*^9, 3.5178382771469088`*^9}, {3.539875838714589*^9, 
   3.5398758804932823`*^9}, 3.539875979734023*^9, {3.53987829249669*^9, 
   3.539878386191471*^9}, {3.539879763767935*^9, 3.539879795691741*^9}, {
   3.539881453108553*^9, 3.539881456164304*^9}, 3.539919374736289*^9, {
   3.539922174250987*^9, 3.539922175570566*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Phi]1", "]"}], "2"], " ", 
         RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Phi]1", "]"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]1", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]2", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Phi]1", "]"}], "2"], " ", 
         RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]1", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]2", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], " ", 
           RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]2", "]"}]}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.50504204989775*^9, 3.505042061503172*^9}, 
   3.505046827325424*^9, 3.505046908340333*^9, 3.505046943179408*^9, 
   3.5050473122778788`*^9, 3.5050473902699633`*^9, 3.505370104042531*^9, 
   3.505370365968279*^9, 3.50537110843816*^9, 3.505371267712812*^9, 
   3.505709833617412*^9, 3.517834082102569*^9, {3.517834537885626*^9, 
   3.5178345861628857`*^9}, {3.517835525403593*^9, 3.517835552691787*^9}, {
   3.517835585368506*^9, 3.517835605030582*^9}, {3.5178356474677563`*^9, 
   3.5178356589168463`*^9}, 3.517837117731999*^9, 3.517837561890513*^9, 
   3.517837649497065*^9, 3.5178382833028507`*^9, 3.517838679964591*^9, 
   3.539875842778245*^9, 3.539875885064128*^9, 3.539875983357149*^9, 
   3.5398761887388067`*^9, 3.539876321855241*^9, {3.5398783729245777`*^9, 
   3.539878390910983*^9}, 3.5398786031539993`*^9, 3.539879767693659*^9, 
   3.5398797991281843`*^9, 3.539881428346895*^9, 3.5398819122733517`*^9, 
   3.5398824583091507`*^9, 3.539921598568061*^9, 3.5399219610964746`*^9, 
   3.5399221244120092`*^9, 3.539926120877842*^9, 3.540347337174862*^9, 
   3.5403478472701197`*^9, 3.540358408151084*^9, {3.540358507681962*^9, 
   3.540358524958887*^9}, 3.540359003687364*^9, 3.540369939346937*^9, 
   3.541079722054435*^9}]
}, Open  ]],

Cell[TextData[{
 "Finally, the Track vector ",
 "at location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "} ",
 "is projected onto the local tangent basis ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["e", "\[Theta]"], ",", 
    SubscriptBox["e", "\[Phi]"]}]}]]],
 "} at that location: ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["e", "\[Theta]"], ".", 
     SubscriptBox["T", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], ",", 
        SubscriptBox["\[Phi]", "1"]}], ")"}]]}], ",", 
    RowBox[{
     SubscriptBox["e", "\[Phi]"], ".", 
     SubscriptBox["T", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], ",", 
        SubscriptBox["\[Phi]", "1"]}], ")"}]]}]}]}]]],
 "}. The two numbers thus obtained are the coordnates of the Track vector in \
this basis:"
}], "Text",
 CellChangeTimes->{{3.5399235716407223`*^9, 3.5399235827170353`*^9}, {
  3.5399236923242064`*^9, 3.539923720419157*^9}, {3.539923977859942*^9, 
  3.5399240597616167`*^9}, {3.539924388480838*^9, 3.5399245026052313`*^9}, {
  3.539924579913113*^9, 3.539924608122897*^9}, {3.540347560346366*^9, 
  3.5403475603465*^9}, {3.540347591215893*^9, 3.540347620945332*^9}},
 TextJustification->1.],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TrackLong1", ",", "TrackLat1"}], "}"}], "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e\[Theta]1", ".", " ", "TrackVect1"}], ",", 
       RowBox[{"e\[Phi]1", " ", ".", " ", "TrackVect1"}]}], "}"}], Cell[""]}],
     "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TP1", "=", 
  RowBox[{"%", "//", "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{
  3.5050255434655323`*^9, {3.505025592478643*^9, 3.5050255976544647`*^9}, {
   3.505025767303782*^9, 3.5050257679031897`*^9}, 3.505026921177391*^9, {
   3.505032724186059*^9, 3.505032732215208*^9}, {3.505032804490115*^9, 
   3.505032820619421*^9}, {3.505033255049283*^9, 3.5050332575206223`*^9}, {
   3.50503597606157*^9, 3.5050360315805473`*^9}, {3.50503623656341*^9, 
   3.505036244394608*^9}, {3.505036275301214*^9, 3.5050362923157053`*^9}, {
   3.505036363551021*^9, 3.505036377006772*^9}, {3.505036432860445*^9, 
   3.5050364704697847`*^9}, {3.517836684239986*^9, 3.517836684812406*^9}, {
   3.51783681885995*^9, 3.517836864089704*^9}, {3.5178369487296743`*^9, 
   3.51783695435909*^9}, {3.517837060841151*^9, 3.517837087244937*^9}, {
   3.517837136028657*^9, 3.517837142615418*^9}, {3.539875906340913*^9, 
   3.53987595145159*^9}, {3.5398759934588833`*^9, 3.5398760040176687`*^9}, {
   3.539922102519017*^9, 3.539922107677392*^9}, {3.540347651281713*^9, 
   3.54034767858444*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}], " ", 
        InterpretationBox[Cell[""],
         TextCell[""]]}]},
      {
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], " ", 
           RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]2", "]"}]}]}], ")"}], " ", 
        InterpretationBox[Cell[""],
         TextCell[""]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.539876006866261*^9, 3.5398761887790527`*^9, 3.539876321891808*^9, 
   3.539878603191927*^9, 3.539879767748975*^9, 3.53988143128826*^9, 
   3.539881912330789*^9, 3.5398824583455257`*^9, 3.539921598881939*^9, 
   3.5399219611469383`*^9, 3.539922131309408*^9, 3.539926120933813*^9, 
   3.5403473374405413`*^9, 3.5403476879620323`*^9, 3.5403478473005943`*^9, 
   3.540358408426539*^9, {3.54035850772253*^9, 3.5403585249948177`*^9}, 
   3.540359003740492*^9, 3.540369939436067*^9, 3.541079722117879*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computation of the Track and the heading, Module Track12\
\>", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}, {
  3.5388045235470953`*^9, 3.5388045267363253`*^9}, {3.538808492449486*^9, 
  3.5388085000464487`*^9}, {3.539920422533615*^9, 3.539920432090354*^9}, {
  3.5399220567490377`*^9, 3.5399220680750217`*^9}, {3.5399224320730352`*^9, 
  3.539922443440487*^9}, {3.539922492952567*^9, 3.539922496702539*^9}, {
  3.5399229388258343`*^9, 3.5399229425222178`*^9}, {3.540347732719407*^9, 
  3.540347745037446*^9}, {3.54034796485533*^9, 3.540347966598715*^9}, {
  3.540359040115856*^9, 3.540359051537649*^9}}],

Cell[TextData[{
 "Making use of the previous considerations, following Module ",
 StyleBox["Track12",
  FontWeight->"Bold"],
 " computes the heading ",
 StyleBox["\[Eta]",
  FontWeight->"Bold"],
 " at location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "} of a mobile sailing from there to location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "2"], ",", 
    SubscriptBox["\[Phi]", "2"]}]}]]],
 "}. The Track vector at location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    SubscriptBox["\[Phi]", "1"]}]}]]],
 "} is firstly projected onto the local tangent basis ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["e", "\[Theta]"], ",", 
    SubscriptBox["e", "\[Phi]"]}], "}"}]]],
 ", then a  classical Arctan computation delivers the heading. Internal \
module ",
 StyleBox["Arctangente",
  FontWeight->"Bold"],
 ", carefully designed in order to catch all possible configurations, \
performs this computation. The last instruction of Track12 transforms the \
mathematical angle given on the trigonometric circle into the heading used in \
navigation with 90\[Degree] towards east, 180\[Degree] towards south, 270\
\[Degree] towards west and 360\[Degree] or 0\[Degree] towards north."
}], "Text",
 CellChangeTimes->{{3.539924205354323*^9, 3.539924302035515*^9}, {
   3.539924333362792*^9, 3.539924348410005*^9}, {3.539924666440228*^9, 
   3.539924804260313*^9}, {3.539925066413032*^9, 3.5399252416084337`*^9}, 
   3.539925372287469*^9, {3.5399254621086063`*^9, 3.539925696684019*^9}, {
   3.539925737093465*^9, 3.53992579953201*^9}, {3.539925832150476*^9, 
   3.539925903333346*^9}, {3.5399267356707077`*^9, 3.53992673992768*^9}, {
   3.539926827930505*^9, 3.539926861217824*^9}, {3.539926900801062*^9, 
   3.5399269114964323`*^9}, 3.539926968447029*^9, {3.540347774802246*^9, 
   3.540347783638332*^9}, {3.540358887951062*^9, 3.540358890123307*^9}, {
   3.54035893150667*^9, 3.5403589428221493`*^9}, {3.5403600938265257`*^9, 
   3.5403601272678328`*^9}, {3.540360158082755*^9, 3.540360164802539*^9}, {
   3.5403607955846767`*^9, 3.540360802784305*^9}, {3.540360937692741*^9, 
   3.54036093835638*^9}},
 TextJustification->1.],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Figure2", "=", 
  RowBox[{"Import", "[", "\"\<Dessin1.jpg\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.540358449572276*^9, 3.540358520634357*^9}, {
  3.5403589746139307`*^9, 3.5403589836048727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Import", "::", "\<\"nffil\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"File not found during \\\\\\\
\"\\\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Import\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\".\\\\\\\"\\\", \\\"MT\\\
\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Import/nffil\\\", ButtonNote -> \
\\\"Import::nffil\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5410797221734962`*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.540358507816884*^9, 3.540358525081156*^9}, 
   3.5403590038295393`*^9, 3.540369939527597*^9, 3.5410797221763773`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Track12", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ArcTangente", ",", "TrackLong1", ",", "TrackLat1", ",", "NTrack1", 
        ",", "\[Theta]1", ",", "\[Phi]1", ",", "\[Theta]2", ",", "\[Phi]2"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ArcTangente", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], ":=", " ", 
        RowBox[{"N", "[", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", ">", "0"}], ")"}], " ", "&&", " ", 
            RowBox[{"(", 
             RowBox[{"y", ">", "0"}], ")"}]}], ",", " ", 
           RowBox[{"ArcTan", "[", 
            FractionBox["y", "x"], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "<", "0"}], ")"}], " ", "&&", " ", 
              RowBox[{"(", 
               RowBox[{"y", ">", "0"}], ")"}]}], ",", " ", 
             RowBox[{"\[Pi]", "-", 
              RowBox[{"ArcTan", "[", 
               FractionBox["y", 
                RowBox[{"Abs", "[", "x", "]"}]], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "<", "0"}], ")"}], " ", "&&", " ", 
                RowBox[{"(", 
                 RowBox[{"y", "<", "0"}], ")"}]}], ",", " ", 
               RowBox[{"\[Pi]", "+", 
                RowBox[{"ArcTan", "[", 
                 FractionBox["y", "x"], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", ">", "0"}], ")"}], " ", "&&", " ", 
                  RowBox[{"(", 
                   RowBox[{"y", "<", "0"}], ")"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"2", "\[Pi]"}], "-", 
                  RowBox[{"ArcTan", "[", 
                   FractionBox[
                    RowBox[{"Abs", "[", "y", "]"}], "x"], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "==", "0"}], ")"}], " ", "&&", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", ">", "0"}], ")"}]}], ",", " ", 
                   FractionBox["\[Pi]", "2"], ",", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "==", "0"}], ")"}], " ", "&&", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", "<", "0"}], ")"}]}], ",", " ", 
                    FractionBox[
                    RowBox[{"3", "\[Pi]"}], "2"], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "<", "0"}], ")"}], " ", "&&", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", "==", "0"}], ")"}]}], ",", " ", "\[Pi]", ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", ">", "0"}], ")"}], " ", "&&", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", "==", "0"}], ")"}]}], ",", " ", "0"}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], "]"}]}],
                 "]"}]}], "]"}]}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]1", ",", "\[Phi]1", ",", "\[Theta]2", ",", "\[Phi]2"}], 
         "}"}], "=", 
        RowBox[{
         FractionBox["\[Pi]", "180"], 
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrackLong1", ",", "TrackLat1"}], "}"}], "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]2", "]"}]}], "-", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Phi]1", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}]}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NTrack1", "=", 
        RowBox[{
         FractionBox["180", "\[Pi]"], 
         RowBox[{"ArcTangente", "[", 
          RowBox[{"TrackLong1", ",", "TrackLat1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NTrack1", ">", "90.0"}], ",", 
         RowBox[{"450.0", "-", "NTrack1"}], ",", 
         RowBox[{"90.0", "-", "NTrack1"}]}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", "Track12", " ", "*)"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{
  3.5050331834967527`*^9, {3.505033321082613*^9, 3.505033365607786*^9}, {
   3.505033443169519*^9, 3.505033493894799*^9}, 3.5050335632240067`*^9, {
   3.505033631311069*^9, 3.50503375745142*^9}, 3.505033866330127*^9, 
   3.505033962290216*^9, {3.505034034765423*^9, 3.505034066288785*^9}, {
   3.505034164102083*^9, 3.5050342234448338`*^9}, {3.5050343313763847`*^9, 
   3.505034349639349*^9}, {3.505034586207262*^9, 3.505034704271193*^9}, {
   3.5050348875571623`*^9, 3.5050349429729347`*^9}, {3.5050350175202*^9, 
   3.505035090808255*^9}, {3.5050352531855707`*^9, 3.505035300800151*^9}, {
   3.5050353387831984`*^9, 3.5050354319530888`*^9}, {3.505035544257236*^9, 
   3.505035546831846*^9}, {3.505035599974695*^9, 3.505035612808466*^9}, {
   3.5050356452312813`*^9, 3.505035669707512*^9}, {3.505036572414851*^9, 
   3.5050366365384293`*^9}, 3.5050422137748423`*^9, {3.505046858279163*^9, 
   3.505046875301105*^9}, {3.50504695691956*^9, 3.505046987208933*^9}, {
   3.505047068483768*^9, 3.505047101230999*^9}, {3.505047141812996*^9, 
   3.5050472200993013`*^9}, {3.505047252018682*^9, 3.505047301141666*^9}, {
   3.505047360583446*^9, 3.505047385925399*^9}, 3.505047460552308*^9, {
   3.5050475907875137`*^9, 3.505047637915812*^9}, {3.505047757642474*^9, 
   3.505047775590769*^9}, {3.5053701796915092`*^9, 3.5053702851892433`*^9}, 
   3.505371205325387*^9, {3.539876117320055*^9, 3.5398761654229527`*^9}, {
   3.539876519652666*^9, 3.539876522518612*^9}, {3.5398768010641603`*^9, 
   3.539876803037507*^9}, {3.539876932864477*^9, 3.539876934919197*^9}, {
   3.539876991234165*^9, 3.539876994535934*^9}, {3.5398788678565893`*^9, 
   3.539878868304496*^9}, {3.539879181697929*^9, 3.539879297462027*^9}, {
   3.5398793480854807`*^9, 3.539879350504678*^9}, 3.5398817231723833`*^9, {
   3.539921611381637*^9, 3.539921614906447*^9}, {3.540360254481503*^9, 
   3.5403602561050997`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Example: computation of distance and heading between two locations: \
\>", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}, {
  3.5388045235470953`*^9, 3.5388045267363253`*^9}, {3.538808492449486*^9, 
  3.5388085000464487`*^9}, {3.539920422533615*^9, 3.539920432090354*^9}, {
  3.5399220567490377`*^9, 3.5399220680750217`*^9}, {3.5399224320730352`*^9, 
  3.539922443440487*^9}, {3.539922492952567*^9, 3.539922496702539*^9}, {
  3.5399229388258343`*^9, 3.5399229425222178`*^9}, {3.5399260317227592`*^9, 
  3.539926104615074*^9}, {3.540348497594006*^9, 3.540348499407549*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Departure", "=", 
   RowBox[{"{", 
    RowBox[{"8", ",", "47"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Arrival", "=", 
   RowBox[{"{", 
    RowBox[{"7", ",", "46"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Orthodromic Distance between Departure and Arrival expressed in \
Nautical Miles: \>\"", " ", ",", 
    RowBox[{"Ortho", "[", 
     RowBox[{"Departure", ",", "Arrival"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Heading in degree between these two locations: \>\"", ",", 
    RowBox[{"Track12", "[", 
     RowBox[{"Departure", ",", "Arrival"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5050473963298388`*^9, 3.50504754517791*^9}, {
   3.505047650063146*^9, 3.505047652750722*^9}, 3.505047697029766*^9, 
   3.5053703768200073`*^9, {3.505370446796321*^9, 3.505370446831934*^9}, 
   3.505370485011239*^9, {3.5053705326417313`*^9, 3.5053705522337313`*^9}, {
   3.505370656406128*^9, 3.505370660934066*^9}, 3.505370704228951*^9, {
   3.505370783962812*^9, 3.505370788689582*^9}, {3.5053708509359493`*^9, 
   3.505370857144227*^9}, 3.505370925094808*^9, 3.505370979348823*^9, {
   3.5053710534052362`*^9, 3.5053710861294622`*^9}, {3.505371286861698*^9, 
   3.5053713042695017`*^9}, {3.505709817935939*^9, 3.505709826919444*^9}, {
   3.5057099307868547`*^9, 3.5057099405927467`*^9}, {3.5398762131000433`*^9, 
   3.539876258578835*^9}, {3.539877057828307*^9, 3.5398770717554483`*^9}, {
   3.539877114338768*^9, 3.539877125466096*^9}, {3.53987717857001*^9, 
   3.5398772332547607`*^9}, 3.5398774023703136`*^9, {3.539877465082037*^9, 
   3.539877502807227*^9}, {3.539877593428755*^9, 3.539877595028511*^9}, {
   3.5398776266133966`*^9, 3.539877630563437*^9}, {3.539877667609634*^9, 
   3.5398777637676277`*^9}, {3.539877862012348*^9, 3.5398779710979757`*^9}, {
   3.539878164412141*^9, 3.539878205233891*^9}, {3.539878240635229*^9, 
   3.539878246401744*^9}, {3.5398785909540653`*^9, 3.539878594975286*^9}, 
   3.5398793768968077`*^9, {3.5398794247360363`*^9, 3.539879426287361*^9}, {
   3.539879526431237*^9, 3.539879569299265*^9}, {3.539881899299796*^9, 
   3.539881902824666*^9}, {3.539881940680067*^9, 3.5398819824625893`*^9}, 
   3.539882017245709*^9, {3.539882479049444*^9, 3.53988248081539*^9}, 
   3.5399215907230873`*^9, {3.539926154008704*^9, 3.539926157872211*^9}, {
   3.5399262327741117`*^9, 3.539926271627825*^9}, {3.539926302260453*^9, 
   3.5399263096918793`*^9}, {3.5403481450448112`*^9, 3.540348343817284*^9}, {
   3.5403483788548613`*^9, 3.540348408933041*^9}, {3.5403485114366407`*^9, 
   3.540348513412184*^9}, {3.540348716071919*^9, 3.5403487171983852`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Orthodromic Distance between Departure and Arrival expressed \
in Nautical Miles: \"\>", "\[InvisibleSpace]", "72.83944630781093`"}],
  SequenceForm[
  "Orthodromic Distance between Departure and Arrival expressed in Nautical \
Miles: ", 72.83944630781093],
  Editable->False]], "Print",
 CellChangeTimes->{{3.540348329752915*^9, 3.5403483488151417`*^9}, {
   3.540348389984523*^9, 3.540348412368723*^9}, 3.540348720518612*^9, 
   3.5403584085213633`*^9, {3.540358507882072*^9, 3.5403585251424007`*^9}, 
   3.540359003902512*^9, 3.540369939595819*^9, 3.541079722254038*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Heading in degree between these two locations: \"\>", 
   "\[InvisibleSpace]", "214.9054825289125`"}],
  SequenceForm[
  "Heading in degree between these two locations: ", 214.9054825289125],
  Editable->False]], "Print",
 CellChangeTimes->{{3.540348329752915*^9, 3.5403483488151417`*^9}, {
   3.540348389984523*^9, 3.540348412368723*^9}, 3.540348720518612*^9, 
   3.5403584085213633`*^9, {3.540358507882072*^9, 3.5403585251424007`*^9}, 
   3.540359003902512*^9, 3.540369939595819*^9, 3.54107972225616*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Computation of the speed of the sailing boat on a given track \
\>", "Subsubtitle",
 CellChangeTimes->{{3.538804443585338*^9, 3.538804461666377*^9}, {
   3.5388045235470953`*^9, 3.5388045267363253`*^9}, {3.538808492449486*^9, 
   3.5388085000464487`*^9}, {3.539920422533615*^9, 3.539920432090354*^9}, {
   3.5399220567490377`*^9, 3.5399220680750217`*^9}, {3.5399224320730352`*^9, 
   3.539922443440487*^9}, {3.539922492952567*^9, 3.539922496702539*^9}, {
   3.5399229388258343`*^9, 3.5399229425222178`*^9}, {3.5399260317227592`*^9, 
   3.539926104615074*^9}, {3.540348027894857*^9, 3.540348072707782*^9}, 
   3.540360261271758*^9}],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  SubscriptBox["W", 
   RowBox[{"(", "t", ")"}]]],
  FormatType->"StandardForm"],
 " =  ",
 Cell[BoxData[
  SubscriptBox[
   RowBox[{"{", 
    RowBox[{"u", ",", " ", "v"}], "}"}], 
   RowBox[{"(", "t", ")"}]]],
  FormatType->"StandardForm"],
 " the wind blowing at location ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{"\[Theta]", ",", "\[Phi]"}]}]]],
 "} when the sailing boat crosses it at time ",
 Cell[BoxData["t"],
  FormatType->"StandardForm"],
 ". ( ",
 Cell[BoxData["u"],
  FormatType->"StandardForm"],
 " and ",
 Cell[BoxData["v"],
  FormatType->"StandardForm"],
 " are called zonal, respectively meridional components of the wind vector. \
The former is directed west- eastwards, along a  latitude circle, the latter \
south- northwards, along a longitude circle). The speed of the sailing boat \
firstly depends on the intensity of the wind ",
 Cell[BoxData[
  RowBox[{"|", 
   SubscriptBox["W", 
    RowBox[{"(", "t", ")"}]], "|"}]]],
 ", secondly on the angle of incidence \[Alpha] of the wind vector onto the \
sails represented as ",
 StyleBox["\[Alpha]",
  FontWeight->"Bold"],
 " on the right panel of figure 2.  Technically, the speed of the sailing \
boat is available as a polar diagramme delivering for each couple ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"|", 
     SubscriptBox["W", 
      RowBox[{"(", "t", ")"}]], "|"}], ",", "\[Alpha]"}], "}"}]]],
 " the speed ",
 StyleBox["\[Rho]",
  FontWeight->"Bold"],
 " expressed in knots (KT)\nPractically, only a few couples of {",
 Cell[BoxData[
  RowBox[{"\[LeftBracketingBar]", "W"}]]],
 " \[LeftBracketingBar], \[Alpha]} values being known, an interpolation \
process has to be implemented in order to enable the computation of an good \
estimation of the sailing boat performance for each wind intensity and attack \
angle. It is encapsulated in the Module ",
 StyleBox["Yacht",
  FontWeight->"Bold"],
 " proposed below. This interpolation is presented in section xxx. Formally, \
the incidence angle \[Alpha] is computed with a scalar product: ",
 Cell[BoxData[
  RowBox[{"\[Alpha]", " ", "=", " ", 
   RowBox[{"180", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       FractionBox["1", "\[DoubledPi]"], 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{"T", ".", "W"}], 
         StyleBox[
          RowBox[{"|", 
           RowBox[{"T", "||", "W"}], "|"}], "Text"]], "]"}]}]}], ")"}]}]}]],
  CellChangeTimes->{{3.54036278715274*^9, 3.540362981106058*^9}}],
 ". "
}], "Text",
 CellChangeTimes->{{3.540359354640538*^9, 3.5403594000277643`*^9}, {
   3.540359468535388*^9, 3.540359470629263*^9}, {3.540359505644487*^9, 
   3.540359746022456*^9}, {3.540359795515918*^9, 3.540359960959859*^9}, {
   3.540360001174479*^9, 3.540360001382168*^9}, {3.540360360470244*^9, 
   3.5403604540418043`*^9}, {3.540361001225863*^9, 3.5403612520190773`*^9}, {
   3.540361306420286*^9, 3.54036139098837*^9}, {3.5403614257374573`*^9, 
   3.540361782266946*^9}, {3.54036185707395*^9, 3.540362188307106*^9}, {
   3.540362222161572*^9, 3.540362349645849*^9}, {3.540362391466889*^9, 
   3.5403623961788607`*^9}, {3.5403624858081923`*^9, 3.540362556013288*^9}, {
   3.540362675322012*^9, 3.540362758708404*^9}, {3.540362989812125*^9, 
   3.540363088672529*^9}, {3.5403631359033213`*^9, 3.540363163316916*^9}, {
   3.540363213669023*^9, 3.540363307299708*^9}, {3.540363361719651*^9, 
   3.540363382365947*^9}, {3.5403634463603477`*^9, 3.540363446988361*^9}, {
   3.540365980233563*^9, 3.540365984919734*^9}, {3.54036603087154*^9, 
   3.540366042584443*^9}, {3.540366269026247*^9, 3.540366295521331*^9}, {
   3.540366342208359*^9, 3.5403664388693123`*^9}, {3.540366538122707*^9, 
   3.5403666024086523`*^9}, {3.540366840090477*^9, 3.540366846313476*^9}, {
   3.540366908144744*^9, 3.540367116946023*^9}, {3.540367368459807*^9, 
   3.540367428017329*^9}, 3.540367520968247*^9, {3.5403679417495728`*^9, 
   3.540367986105934*^9}, 3.540368028358695*^9},
 TextJustification->1.],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Yacht", "[", 
    RowBox[{"W_", ",", "A_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "MinA", ",", " ", "MinW", ",", " ", "MaxW", ",", "InterpolationVoilier",
        ",", "MinimumSpeed"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"MinA", ",", "MinW", ",", "MaxW", ",", "MinimumSpeed"}], 
        "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"30", ",", "0.3", ",", "30", ",", "0.01"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"A", "<", "MinA"}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{"W", "<", "MinW"}], ")"}]}], " ", ",", "MinimumSpeed", ",", 
        "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"W", ">", "MaxW"}], ")"}], " ", ",", 
          RowBox[{"InterpolationVoilier", "[", 
           RowBox[{"MaxW", ",", "A"}], "]"}], ",", "\n", "\t  ", 
          RowBox[{"InterpolationVoilier", "[", 
           RowBox[{"W", ",", "A"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.540365989938389*^9, 3.540365989940219*^9}, {
  3.540366050077395*^9, 3.540366150251577*^9}, {3.540366312422414*^9, 
  3.5403663255666523`*^9}, {3.540366444243021*^9, 3.540366479347109*^9}, {
  3.540366526084662*^9, 3.540366529073818*^9}, {3.5403666276391172`*^9, 
  3.540366628174919*^9}, {3.540368127989646*^9, 3.540368143435602*^9}, {
  3.5403682871117764`*^9, 3.5403682876554623`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SpeadBoat", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "W", ",", "\[Theta]1", ",", "\[Phi]1", ",", "\[Theta]2", ",", 
        "\[Phi]2", ",", "TrackLong1", ",", "TrackLat1", ",", "T", ",", 
        "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"W", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["u", "2"], "+", 
          SuperscriptBox["v", "2"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]1", ",", "\[Phi]1", ",", "\[Theta]2", ",", "\[Phi]2"}], 
         "}"}], "=", 
        RowBox[{
         FractionBox["\[Pi]", "180"], 
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrackLong1", ",", "TrackLat1"}], "}"}], "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]1", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]2", "]"}]}], "-", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Phi]1", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}]}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"T", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["TrackLong1", "2"], "+", 
          SuperscriptBox["TrackLat1", "2"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", " ", "=", " ", 
        RowBox[{"180", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox["1", "Pi"], 
            RowBox[{"ArcCos", "[", 
             RowBox[{
              FractionBox["1", 
               StyleBox[
                RowBox[{"T", "  ", "W"}], "Text"]], 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"TrackLong1", ",", "TrackLat1"}], "}"}], ".", 
               RowBox[{"{", 
                RowBox[{"u", ",", "v"}], "}"}]}]}], "]"}]}]}], ")"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Yacht", "[", 
        RowBox[{"W", ",", "\[Alpha]"}], "]"}]}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.540363606739586*^9, 3.540363635824008*^9}, {
   3.540363681414776*^9, 3.540363934449445*^9}, {3.540363989920186*^9, 
   3.540364128227504*^9}, {3.5403641632414913`*^9, 3.540364186069029*^9}, {
   3.540364553255427*^9, 3.540364553470869*^9}, {3.540365113697542*^9, 
   3.540365226909951*^9}, 3.540365257550498*^9, {3.540365339804072*^9, 
   3.5403654376338053`*^9}, {3.540365515625102*^9, 3.540365581495307*^9}, {
   3.540365961973668*^9, 3.540365968175675*^9}, {3.540366178574554*^9, 
   3.540366180196653*^9}, {3.540366221971856*^9, 3.540366232554042*^9}, {
   3.540366704349457*^9, 3.5403667286911287`*^9}, 3.54036676490908*^9, 
   3.540366825426722*^9}],

Cell[TextData[{
 "Remarks:\n\n1. The Module ",
 StyleBox["Yacht",
  FontWeight->"Bold"],
 " given hereafter is incomplete. MinA, MinW, MaxW have been set at arbitrary \
values. They have to be provided as information related to the polar \
diagramme by the procedure ",
 StyleBox["InterpolationVoilier",
  FontWeight->"Bold"],
 ". The tests implemented in ",
 StyleBox["Yacht",
  FontWeight->"Bold"],
 " on MinA, MinW, MaxW provide minumum speed for the sailing boat if the \
incidence angle is lower than 30\[Degree], or if the wind is weaker than 0.3 \
KT, and consider the maximum wind speed in the table if the true wind is \
stronger than that value.\n \n2. arcs being very short for lake routing, \
track vectors and headings remain unchanged at departure and arrival nodes. \
Therefore, the same procedure can be used to compute the speed of the sailing \
boat at both nodes, of course with the related winds. This property is \
applied hereafter for the computation of the sailing duration betwen two \
nodes.\n"
}], "Text",
 CellChangeTimes->{{3.540359354640538*^9, 3.5403594000277643`*^9}, {
   3.540359468535388*^9, 3.540359470629263*^9}, {3.540359505644487*^9, 
   3.540359746022456*^9}, {3.540359795515918*^9, 3.540359960959859*^9}, {
   3.540360001174479*^9, 3.540360001382168*^9}, {3.540360360470244*^9, 
   3.5403604540418043`*^9}, {3.540361001225863*^9, 3.5403612520190773`*^9}, {
   3.540361306420286*^9, 3.54036139098837*^9}, {3.5403614257374573`*^9, 
   3.540361782266946*^9}, {3.54036185707395*^9, 3.540362188307106*^9}, {
   3.540362222161572*^9, 3.540362349645849*^9}, {3.540362391466889*^9, 
   3.5403623961788607`*^9}, {3.5403624858081923`*^9, 3.540362556013288*^9}, {
   3.540362675322012*^9, 3.540362758708404*^9}, {3.540362989812125*^9, 
   3.540363088672529*^9}, {3.5403631359033213`*^9, 3.540363163316916*^9}, {
   3.540363213669023*^9, 3.540363307299708*^9}, {3.540363361719651*^9, 
   3.540363382365947*^9}, {3.5403634463603477`*^9, 3.540363446988361*^9}, {
   3.540365980233563*^9, 3.540365984919734*^9}, {3.54036603087154*^9, 
   3.540366042584443*^9}, {3.540366269026247*^9, 3.540366295521331*^9}, {
   3.540366342208359*^9, 3.5403664388693123`*^9}, {3.540366538122707*^9, 
   3.5403666024086523`*^9}, {3.540366840090477*^9, 3.540366846313476*^9}, {
   3.540366908144744*^9, 3.540367116946023*^9}, {3.540367368459807*^9, 
   3.540367428017329*^9}, 3.540367520968247*^9, {3.5403679417495728`*^9, 
   3.540367986105934*^9}, {3.540368028358695*^9, 3.540368037543559*^9}, {
   3.540368115111208*^9, 3.540368119286273*^9}, {3.540368161500497*^9, 
   3.5403682840002937`*^9}, {3.540368319887734*^9, 3.540368398971847*^9}, {
   3.540368436701165*^9, 3.540368443132833*^9}, 3.540368952555221*^9, {
   3.540369183621284*^9, 3.54036927497188*^9}, {3.540369323675344*^9, 
   3.540369376178019*^9}, {3.54036975571931*^9, 3.540369779486154*^9}},
 TextJustification->1.]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sailing Duration", "Subsubtitle",
 CellChangeTimes->{{3.540368881262686*^9, 3.540368921933662*^9}}],

Cell[TextData[{
 "The time elapsed on the track separating two nodes located at ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{"\[Theta]1", ",", "\[Phi]1"}]}]]],
 "} and ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{"\[Theta]2", ",", "\[Phi]2"}]}]]],
 "} is given by the following procedure. Winds {ui, vi}, i = 1, 2,  have to \
provided for the corresponding node at the time at which the sailing boat \
crosses this node. Expecting that this condition will be satisfied, the \
sailing duration is simply given by the length of the track divided by the \
average speed on the it:\n "
}], "Text",
 CellChangeTimes->{{3.540359354640538*^9, 3.5403594000277643`*^9}, {
   3.540359468535388*^9, 3.540359470629263*^9}, {3.540359505644487*^9, 
   3.540359746022456*^9}, {3.540359795515918*^9, 3.540359960959859*^9}, {
   3.540360001174479*^9, 3.540360001382168*^9}, {3.540360360470244*^9, 
   3.5403604540418043`*^9}, {3.540361001225863*^9, 3.5403612520190773`*^9}, {
   3.540361306420286*^9, 3.54036139098837*^9}, {3.5403614257374573`*^9, 
   3.540361782266946*^9}, {3.54036185707395*^9, 3.540362188307106*^9}, {
   3.540362222161572*^9, 3.540362349645849*^9}, {3.540362391466889*^9, 
   3.5403623961788607`*^9}, {3.5403624858081923`*^9, 3.540362556013288*^9}, {
   3.540362675322012*^9, 3.540362758708404*^9}, {3.540362989812125*^9, 
   3.540363088672529*^9}, {3.5403631359033213`*^9, 3.540363163316916*^9}, {
   3.540363213669023*^9, 3.540363307299708*^9}, {3.540363361719651*^9, 
   3.540363382365947*^9}, {3.5403634463603477`*^9, 3.540363446988361*^9}, {
   3.540365980233563*^9, 3.540365984919734*^9}, {3.54036603087154*^9, 
   3.540366042584443*^9}, {3.540366269026247*^9, 3.540366295521331*^9}, {
   3.540366342208359*^9, 3.5403664388693123`*^9}, {3.540366538122707*^9, 
   3.5403666024086523`*^9}, {3.540366840090477*^9, 3.540366846313476*^9}, {
   3.540366908144744*^9, 3.540367116946023*^9}, {3.540367368459807*^9, 
   3.540367428017329*^9}, 3.540367520968247*^9, {3.5403679417495728`*^9, 
   3.540367986105934*^9}, {3.540368028358695*^9, 3.540368037543559*^9}, {
   3.540368115111208*^9, 3.540368119286273*^9}, {3.540368161500497*^9, 
   3.5403682840002937`*^9}, {3.540368319887734*^9, 3.540368398971847*^9}, {
   3.540368436701165*^9, 3.540368443132833*^9}, {3.5403690026036177`*^9, 
   3.540369040898608*^9}, {3.5403690741607122`*^9, 3.54036909732157*^9}, {
   3.540369398075684*^9, 3.5403697208177433`*^9}, {3.54036980787869*^9, 
   3.540369808783085*^9}, {3.540369882095331*^9, 3.540369893156828*^9}},
 TextJustification->1.],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SailingDuration", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u1_", ",", "v1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u2_", ",", "v2_"}], "}"}]}], "]"}], ":=", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"Ortho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"SpeadBoat", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u1", ",", "v1"}], "}"}]}], "]"}], "+", 
     RowBox[{"SpeadBoat", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u2", ",", "v2"}], "}"}]}], "]"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.540368531896545*^9, 3.540368593530949*^9}, {
  3.54036863982143*^9, 3.540368674608595*^9}, {3.540368709270619*^9, 
  3.540368833343959*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1304, 751},
WindowMargins->{{Automatic, 54}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 164, 2, 46, "Subtitle"],
Cell[CellGroupData[{
Cell[768, 28, 470, 8, 43, "Input"],
Cell[1241, 38, 512, 8, 27, "Output"],
Cell[1756, 48, 1438, 34, 211, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3231, 87, 106, 1, 26, "Subsubtitle"],
Cell[3340, 90, 2467, 73, 149, "Text"],
Cell[5810, 165, 2110, 38, 27, "Input"],
Cell[CellGroupData[{
Cell[7945, 207, 494, 8, 27, "Input"],
Cell[8442, 217, 573, 11, 23, "Message"],
Cell[9018, 230, 315, 5, 27, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9382, 241, 152, 2, 26, "Subsubtitle"],
Cell[9537, 245, 5377, 123, 209, "Text"],
Cell[CellGroupData[{
Cell[14939, 372, 674, 19, 73, "Input"],
Cell[15616, 393, 659, 15, 27, "Output"]
}, Open  ]],
Cell[16290, 411, 1749, 46, 136, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18076, 462, 212, 3, 26, "Subsubtitle"],
Cell[18291, 467, 3514, 81, 106, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21842, 553, 360, 5, 26, "Subsubtitle"],
Cell[22205, 560, 4956, 123, 138, "Text"],
Cell[27164, 685, 2340, 43, 67, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29541, 733, 559, 7, 26, "Subsubtitle"],
Cell[30103, 742, 4159, 94, 64, "Text"],
Cell[CellGroupData[{
Cell[34287, 840, 1732, 30, 43, "Input"],
Cell[36022, 872, 3996, 90, 79, "Output"]
}, Open  ]],
Cell[40033, 965, 1349, 41, 33, "Text"],
Cell[CellGroupData[{
Cell[41407, 1010, 1456, 28, 43, "Input"],
Cell[42866, 1040, 1905, 48, 59, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44820, 1094, 649, 10, 26, "Subsubtitle"],
Cell[45472, 1106, 2300, 54, 62, "Text"],
Cell[CellGroupData[{
Cell[47797, 1164, 225, 4, 27, "Input"],
Cell[48025, 1170, 575, 11, 23, "Message"],
Cell[48603, 1183, 174, 2, 27, "Output"]
}, Open  ]],
Cell[48792, 1188, 7791, 173, 501, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56620, 1366, 615, 9, 26, "Subsubtitle"],
Cell[CellGroupData[{
Cell[57260, 1379, 2765, 48, 73, "Input"],
Cell[CellGroupData[{
Cell[60050, 1431, 622, 11, 20, "Print"],
Cell[60675, 1444, 555, 10, 20, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61291, 1461, 642, 11, 43, "Subsubtitle"],
Cell[61936, 1474, 4011, 96, 110, "Text"],
Cell[65950, 1572, 1636, 41, 88, "Input"],
Cell[67589, 1615, 3558, 90, 220, "Input"],
Cell[71150, 1707, 2891, 47, 146, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74078, 1759, 105, 1, 26, "Subsubtitle"],
Cell[74186, 1762, 2532, 41, 56, "Text"],
Cell[76721, 1805, 1305, 40, 49, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
